---
tags:
  - 音视频
  - WebCodecs
  - WebAV
date: 2024-07-09
---

# 纯 Web 实现视频剪辑

## 前言

WebCodecs API 为 Web 平台提供了音视频编解码能力，因此在 Web 平台（网页、Electron）上实现高效、专业的视频剪辑成品成为可能。

<!-- link -->

读者可通过笔者的[系列文章][1]，了解 Webcodecs API 的用法和 Web 音视频基础知识。

## 业务背景 & 方案分析

为了解决主播投稿场景中，需要对直播视频进行加工的诉求，我们需要开发一款轻量视频剪辑产品。
希望能在线上完成 直播 - 编辑 - 投稿 流程。

现有的方案关于视频处理的实现

- 云端（ffmpeg）
- ffmpeg.wasm
- WebCodecs

|        | 云端 | ffmpeg.wasm | webcodecs |
| ------ | ---- | ----------- | --------- |
| 生态   |      |             |           |
| 扩展性 |      |             |           |
| 兼容性 |      |             |           |
| 成本   |      |             |           |
| 性能   |      |             |           |

### 优点

- 成本：只需要少量 Web 开发即可完成前端剪辑功能，且不需要服务器运行、维护成本
- 扩展性：能轻松与 Canvas、WebAudio 配合，实现自定义功能

### 缺点

WebCodecs 方案的缺点在于生态成熟度、与兼容性。

鉴于前期并不需要丰富的产品功能（如滤镜、动效），且 WebCodecs 非常容易起扩展，实现这些功能也不会太难。
鉴于前期并只需要。。。

综合考虑

## 数据处理流程

## 基础能力

WebAV

方案选择参考 [ffcreator][2] 的总结

> 大多数视频处理通常离不开 FFmpeg 这个库，虽然 FFmpeg 在视频处理方面具有十分强大的功能。 但是在处理精细的动画效果方面 FFmpeg 就显得力不从心，并且它的使用也很不方便，需要开发去拼接大段的命令行参数。

[1]: https://hughfenghen.github.io/tag/WebAV/
[2]: https://tnfe.github.io/FFCreator/#/README?id=原理简介

<!-- 跨平台：支持在 Edge、Chrome 浏览器，以及 Electron 中运行
体积小：约 50kb（MINIFIED + GZIPPED, 未 tree-shaking） -->

<!-- 接下来剪辑产品主要功能是如何实现的， -->

若读者想了解能力 关于基础能力

- 纯 Web 视频剪辑原理
  - 业务背景、方案调研分析
    - 方案对比：服务端方案、浏览器方案
      - 维度：生态成熟度，扩展灵活性，兼容性，开发成本（方案复杂度），运行成本
      - 结合 用户特征（主播）、产品特性（轻量）
  - Web 音视频数据处理流程
    - 视频 - 帧（图像） - 处理（canvas/WebGL） - 新帧 - 视频
    - 音频 - PCM - 处理（WebAudio） - 新 PCM - 音频
  - 基础能力
    - 加载、解析视频
    - 遍历帧、寻帧
    - 图像处理、音频处理
    - 动画
  - 主要功能原理：预览播放、素材管理、时间轴
  - 其他功能原理：贴纸、滤镜、转场、特效
  - 边界 case
